minimum_cumulusci_version: '3.43.0'
project:
    name: cUnite_HostelBooking
    package:
        name: 'cUnite Hostel Booking'
        namespace: cUnite
        api_version: '64.0'
    git:
    source_format: sfdx

flows:

    config_dev:
        steps:
            3:
                task: assign_permission_sets
                options:
                    api_names: Hostel_Booking_Admin,Hostel_Booking_User
            91:
                task: load_sample_reservations

    release_2gp_beta:
        steps:
            90:
                task: github_release_notes
                options:
                    tag_name: "latest_beta"

    release_2gp_production:
        steps:
            90:
                task: github_release_notes
                options:
                    tag_name: "latest"

tasks:

    load_sample_data:
        class_path: cumulusci.tasks.bulkdata.snowfakery.Snowfakery
        options:
            recipe: datasets/sample_data.yml

    load_sample_reservations:
        class_path: cumulusci.tasks.bulkdata.snowfakery.Snowfakery
        options:
            recipe: datasets/sample_reservations.yml

    run_tests:
        options:
            required_org_code_coverage_percent: 90

orgs:
    scratch:
        build:
            config_file: orgs/build.json

        packaging:
            config_file: orgs/packaging.json

        dev:
            config_file: orgs/dev.json
            days: 30
            namespaced: True
